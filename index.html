<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì²­ì¶˜ ì—°ê°„ ì‹œë®¬ë ˆì´í„°</title>
<style>
  body {
    font-family: 'Noto Sans KR', sans-serif;
    background: linear-gradient(to bottom, #fff7e8, #ffeedd);
    padding: 20px;
    margin: 0;
  }
  h1 {
    text-align: center;
    font-size: 2em;
    color: #ff6f61;
    margin-bottom: 10px;
  }
  #dateDisplay {
    text-align: center;
    font-size: 1.2em;
    color: #555;
    margin-bottom: 20px;
  }
  button {
    margin: 5px;
    padding: 8px 12px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    background-color: #ffb380;
    color: white;
    font-weight: bold;
  }
  button:hover {
    background-color: #ffa64d;
  }
  .card {
    background: #fff;
    padding: 10px 15px;
    border-radius: 8px;
    margin-bottom: 10px;
    box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
  }
  input[type="text"], input[type="number"] {
    padding: 5px;
    margin: 3px 0;
    width: 90%;
    border-radius: 4px;
    border: 1px solid #ccc;
  }
  #logContent {
    max-height: 300px;
    overflow-y: auto;
    margin-top: 10px;
    padding: 10px;
    background: #fffaf0;
    border-radius: 8px;
  }
  #logContent div {
    margin-bottom: 10px;
  }
  .log-date {
    font-weight: bold;
    margin-bottom: 5px;
  }
</style>
</head>
<body>

<h1>ğŸŒ¸ ì²­ì¶˜ ì—°ê°„ ì‹œë®¬ë ˆì´í„° ğŸŒ¸</h1>
<div id="dateDisplay"></div>

<div style="text-align:center;">
  <button onclick="nextDay()">â¡ ë‹¤ìŒ ë‚ </button>
  <button onclick="showDailyLog()">ğŸ“– ì˜¤ëŠ˜ ì¼ê³¼ ë³´ê¸°</button>
  <button onclick="showStudents()">ğŸ‘©â€ğŸ“ í•™ìƒ ëª…ë‹¨</button>
  <button onclick="showAdd()">â• ìºë¦­í„° ì¶”ê°€</button>
  <button onclick="clearDailyLogs()">ğŸ—‘ï¸ ê¸°ë¡ ì‚­ì œ</button>
</div>

<div id="main"></div>

<div id="logContent"></div>

<script>
// ---------------- state ----------------
let state = {
  date: new Date(2026, 2, 2), // 3ì›” 2ì¼
  characters: [],
  dailyLogs: []
};

// ---------------- ìœ í‹¸ ----------------
function formatDate(d){
  const month = d.getMonth()+1;
  const day = d.getDate();
  return `${month}ì›” ${day}ì¼`;
}
function getSeason(d){
  const m = d.getMonth()+1;
  if(m >=3 && m<=5) return "ë´„";
  if(m >=6 && m<=8) return "ì—¬ë¦„";
  if(m >=9 && m<=11) return "ê°€ì„";
  return "ê²¨ìš¸";
}
function updateDateDisplay(){
  document.getElementById("dateDisplay").innerText = `ğŸ“… ${formatDate(state.date)} Â· ${getSeason(state.date)}`;
}

// ---------------- ë‹¤ìŒ ë‚  ----------------
async function nextDay(){
  // ë‚ ì§œ ì¦ê°€
  const prevMonth = state.date.getMonth();
  state.date.setDate(state.date.getDate()+1);

  // 3í•™ë…„ 12ì›” 31ì¼ â†’ 1ì›” 1ì¼ ì¡¸ì—… ì´ë²¤íŠ¸
  if(prevMonth===11 && state.date.getMonth()===0){
    await handleGraduation();
  }

  // í•˜ë£¨ì¼ê³¼ ìƒì„± (AI)
  await generateDailyLog();

  updateDateDisplay();
}

// ---------------- ì¡¸ì—… ì§„ë¡œ ----------------
async function handleGraduation(){
  for(let c of state.characters){
    if(c.grade===3 && !c.graduated){
      c.graduated = true;
      let choice = prompt(`${c.name || "ì´ë¦„ ì—†ìŒ"}ëŠ” ì´í›„ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?\n1. ëŒ€í•™êµ ì…í•™\n2. ëŒ€í•™êµ ì…í•™í•˜ì§€ ì•ŠìŒ`);
      if(choice==="1"){
        c.postGrad = "ëŒ€í•™ìƒ";
      } else if(choice==="2"){
        let job = prompt(`${c.name || "ì´ë¦„ ì—†ìŒ"}ëŠ” ì–´ë–¤ ì¼ì„ í•˜ê²Œ ë˜ë‚˜ìš”?`);
        c.postGrad = job || "ë¯¸ì •";
      } else {
        c.postGrad = "ë¯¸ì •";
      }
    }
  }
}

// ---------------- í•™ìƒ ëª…ë‹¨ ----------------
function showStudents(){
  let html = "";
  if(state.characters.length===0){
    html = "í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤.";
  } else {
    state.characters.forEach((c,i)=>{
      html += `<div class="card">
        <b>${c.name || "ì´ë¦„ ì—†ìŒ"}</b> (${c.graduated?"ì¡¸ì—…ìƒ":c.grade+"í•™ë…„"})<br>
        <span class="small">${c.personality.join(", ")}</span><br>
        <button onclick="editChar(${i})">âœï¸ ìˆ˜ì •</button>
        <button onclick="removeChar(${i})">âŒ ì‚­ì œ</button>
      </div>`;
    });
  }
  document.getElementById("main").innerHTML = html;
}

// ---------------- ìºë¦­í„° ì¶”ê°€ ----------------
function showAdd(){
  document.getElementById("main").innerHTML = `
    <div class="card">
      ì´ë¦„ <input id="charName" type="text"><br>
      í•™ë…„ <input id="grade" type="number" min="1" max="3"><br>
      ì„±ê²© í‚¤ì›Œë“œ(ì‰¼í‘œ) <input id="per" type="text"><br>
      <button onclick="addChar()">ì¶”ê°€</button>
    </div>
  `;
}
function addChar(){
  const name = (document.getElementById("charName").value||"").trim();
  const grade = Number(document.getElementById("grade").value);
  const personality = (document.getElementById("per").value||"").split(",").map(s=>s.trim()).filter(Boolean);
  if(!name || !grade || personality.length===0){
    alert("ì´ë¦„, í•™ë…„, ì„±ê²© í‚¤ì›Œë“œë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    return;
  }
  state.characters.push({name, grade, personality, graduated:false, postGrad:null});
  showStudents();
}
function editChar(i){
  const c = state.characters[i];
  document.getElementById("main").innerHTML = `
    <div class="card">
      ì´ë¦„ <input id="charName" type="text" value="${c.name || ""}"><br>
      í•™ë…„ <input id="grade" type="number" min="1" max="3" value="${c.grade}"><br>
      ì„±ê²© í‚¤ì›Œë“œ <input id="per" type="text" value="${c.personality.join(", ")}"><br>
      <button onclick="saveChar(${i})">ì €ì¥</button>
    </div>
  `;
}
function saveChar(i){
  const name = (document.getElementById("charName").value||"").trim();
  const grade = Number(document.getElementById("grade").value);
  const personality = (document.getElementById("per").value||"").split(",").map(s=>s.trim()).filter(Boolean);
  if(!name || !grade || personality.length===0){
    alert("ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    return;
  }
  state.characters[i].name = name;
  state.characters[i].grade = grade;
  state.characters[i].personality = personality;
  showStudents();
}
function removeChar(i){
  if(confirm("ì‚­ì œí• ê¹Œìš”?")){
    state.characters.splice(i,1);
    showStudents();
  }
}

// ---------------- í•˜ë£¨ì¼ê³¼ ê¸°ë¡ ----------------
function showDailyLog(){
  const logDiv = document.getElementById("logContent");
  logDiv.scrollTop = logDiv.scrollHeight;
}

function clearDailyLogs(){
  if(confirm("ì§€ê¸ˆê¹Œì§€ì˜ í•˜ë£¨ì¼ê³¼ ê¸°ë¡ì„ ì‚­ì œí• ê¹Œìš”?")){
    state.dailyLogs = [];
    document.getElementById("logContent").innerHTML="";
  }
}

// ---------------- AI í•˜ë£¨ì¼ê³¼ ìƒì„± ----------------
async function generateDailyLog(){
  const dateStr = formatDate(state.date);
  const season = getSeason(state.date);
  
  // ì´ë²¤íŠ¸ ì²´í¬
  let event = "";
  const month = state.date.getMonth()+1;
  const day = state.date.getDate();
  if(month===3 && day===2) event="ì…í•™ì‹";
  else if(month===4 && day>=1 && day<=7) event="ì¤‘ê°„ê³ ì‚¬";
  else if(month===6 && day>=1 && day<=7) event="ê¸°ë§ê³ ì‚¬";
  else if(month>=7 && month<=8) event="ë°©í•™";
  else if(month===9) event="ì²´ìœ¡ëŒ€íšŒ";
  else if(month===10 && day>=1 && day<=7) event="ì¤‘ê°„ê³ ì‚¬";
  else if(month===12 && day>=1 && day<=7) event="ê¸°ë§ê³ ì‚¬";
  else if(month===2 && day>=10 && day<=15) event="ì¡¸ì—…ì‹";

  // ì‹¤ì œ GPT í˜¸ì¶œ ë¶€ë¶„ (ì˜ˆì‹œ)
  // ì—¬ê¸°ì„œëŠ” demoìš©ìœ¼ë¡œ ëœë¤ ìƒì„±
  let logText = "";
  state.characters.forEach(c=>{
    let mood = ["ì¦ê²ê²Œ","ì¡°ê¸ˆ í”¼ê³¤í•˜ì§€ë§Œ","í™œë°œí•˜ê²Œ","ì„¤ë ˆëŠ” ë§ˆìŒìœ¼ë¡œ"];
    let action = ["ìˆ˜ì—…ì„ ë“¤ì—ˆë‹¤","ì¹œêµ¬ì™€ ìˆ˜ë‹¤ë¥¼ ë–¨ì—ˆë‹¤","ìš´ë™ì¥ì—ì„œ ì‹œê°„ì„ ë³´ëƒˆë‹¤","ì ì‹¬ì‹œê°„ì— ê°„ì‹ì„ ë¨¹ì—ˆë‹¤"];
    logText += `<div><span class="log-date">${dateStr} - ${c.name || "ì´ë¦„ ì—†ìŒ"}</span><br>ì˜¤ëŠ˜ í•˜ë£¨ëŠ” ${season} ë¶„ìœ„ê¸° ì†ì—ì„œ ${event || "í‰ë²”í•œ í•˜ë£¨"}ë¥¼ ë³´ë‚´ë©°, ${mood[Math.floor(Math.random()*mood.length)]} ${action[Math.floor(Math.random()*action.length)]}.</div>`;
  });
  state.dailyLogs.push(logText);

  // ë Œë”ë§
  const logDiv = document.getElementById("logContent");
  logDiv.innerHTML = state.dailyLogs.join("");
  logDiv.scrollTop = logDiv.scrollHeight;
}

updateDateDisplay();
</script>

</body>
</html>
