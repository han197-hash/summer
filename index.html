<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>청춘 연간 시뮬레이터</title>
<style>
body { font-family: sans-serif; background:#f7f7f7; padding:20px; }
button { margin:5px; padding:6px 10px; }
.card { background:#fff; padding:10px; margin:10px 0; border-radius:6px; }
input { margin:3px; }
.small { color:#666; font-size:12px; }
</style>
</head>
<body>

<h2 id="date"></h2>

<button onclick="nextDay()">하루 일과</button>
<button onclick="showStudents()">학생 명단</button>
<button onclick="showAdd()">캐릭터 추가</button>

<div id="main"></div>

<script>
let state = {
  date: new Date(2026, 2, 2),
  characters: []
};

function formatDate(d){
  return `${d.getMonth()+1}월 ${d.getDate()}일`;
}

function updateDate(){
  document.getElementById("date").innerText =
    `${formatDate(state.date)}`;
}

function nextDay(){
  state.date.setDate(state.date.getDate()+1);
  let text = "";

  state.characters.forEach(c=>{
    if(c.graduated){
      text += `${c.name}는 졸업 후 ${c.postGrad || "자신의 시간을"} 보내고 있다.\n`;
    } else {
      text += `${c.name}는 학교에서 하루를 보냈다.\n`;
    }
  });

  document.getElementById("main").innerText = text || "아직 캐릭터가 없다.";
  checkGraduation();
  updateDate();
}

function showStudents(){
  let html = "";
  state.characters.forEach((c,i)=>{
    html += `<div class="card">
      <b>${c.name}</b> (${c.graduated?"졸업생":c.grade+"학년"})<br>
      <span class="small">${c.personality.join(", ")}</span><br>
      <button onclick="editChar(${i})">수정</button>
      <button onclick="removeChar(${i})">삭제</button>
    </div>`;
  });
  document.getElementById("main").innerHTML = html || "학생이 없다.";
}

function showAdd(){
  document.getElementById("main").innerHTML = `
    <div class="card">
      이름 <input id="name"><br>
      학년 <input id="grade" type="number" min="1" max="3"><br>
      성격 키워드(쉼표) <input id="per"><br>
      <button onclick="addChar()">추가</button>
    </div>
  `;
}

function addChar(){
  state.characters.push({
    name: name.value,
    grade: Number(grade.value),
    personality: per.value.split(","),
    graduated: false,
    postGrad: null
  });
  showStudents();
}

function editChar(i){
  const c = state.characters[i];
  document.getElementById("main").innerHTML = `
    <div class="card">
      이름 <input id="name" value="${c.name}"><br>
      학년 <input id="grade" type="number" value="${c.grade}"><br>
      성격 키워드 <input id="per" value="${c.personality.join(",")}"><br>
      <button onclick="saveChar(${i})">저장</button>
    </div>
  `;
}

function saveChar(i){
  state.characters[i].name = name.value;
  state.characters[i].grade = Number(grade.value);
  state.characters[i].personality = per.value.split(",");
  showStudents();
}

function removeChar(i){
  if(confirm("삭제할까?")) {
    state.characters.splice(i,1);
    showStudents();
  }
}

function checkGraduation(){
  state.characters.forEach(c=>{
    if(!c.graduated && c.grade===3 && state.date.getMonth()>=1){
      c.graduated = true;
      const r = prompt(`${c.name}는 졸업 후 어떻게 되나요?\n1. 대학교\n2. 아르바이트\n3. 백수`);
      c.postGrad = r==="1"?"대학생":r==="2"?"아르바이트":"백수";
    }
  });
}

updateDate();
</script>

</body>
</html>
