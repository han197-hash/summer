<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>청춘 연간 시뮬레이터</title>
<style>
body { font-family: sans-serif; background:#f7f7f7; padding:20px; }
button { margin:5px; padding:6px 10px; }
.card { background:#fff; padding:10px; margin:10px 0; border-radius:6px; }
input { margin:3px; }
.small { color:#666; font-size:12px; }
</style>
</head>
<body>

<h2 id="date"></h2>

<button onclick="nextDay()">하루 일과</button>
<button onclick="showStudents()">학생 명단</button>
<button onclick="showAdd()">캐릭터 추가</button>

<div id="main"></div>

<script>
let state = {
  date: new Date(2026, 2, 2),
  characters: []
};

function formatDate(d){
  return `${d.getMonth()+1}월 ${d.getDate()}일`;
}

function updateDate(){
  document.getElementById("date").innerText = `${formatDate(state.date)}`;
}

// 하루 일과
function nextDay(){
  state.date.setDate(state.date.getDate()+1);
  let text = "";

  if(state.characters.length === 0){
    text = "아직 캐릭터가 없습니다. 캐릭터를 추가해주세요.";
  } else {
    state.characters.forEach(c=>{
      if(c.graduated){
        text += `${c.name || "이름 없음"}는 졸업 후 ${c.postGrad || "자신의 시간을"} 보내고 있다.\n`;
      } else {
        text += `${c.name || "이름 없음"}는 학교에서 하루를 보냈다.\n`;
      }
    });
  }

  document.getElementById("main").innerText = text;
  checkGraduation();
  updateDate();
}

// 학생 명단
function showStudents(){
  let html = "";
  if(state.characters.length === 0){
    html = "학생이 없습니다.";
  } else {
    state.characters.forEach((c,i)=>{
      html += `<div class="card">
        <b>${c.name || "이름 없음"}</b> (${c.graduated?"졸업생":c.grade+"학년"})<br>
        <span class="small">${c.personality.join(", ")}</span><br>
        <button onclick="editChar(${i})">수정</button>
        <button onclick="removeChar(${i})">삭제</button>
      </div>`;
    });
  }
  document.getElementById("main").innerHTML = html;
}

// 캐릭터 추가 화면
function showAdd(){
  document.getElementById("main").innerHTML = `
    <div class="card">
      이름 <input id="charName"><br>
      학년 <input id="grade" type="number" min="1" max="3"><br>
      성격 키워드(쉼표) <input id="per"><br>
      <button onclick="addChar()">추가</button>
    </div>
  `;
}

// 캐릭터 추가
function addChar(){
  const name = (document.getElementById("charName").value || "").trim();
  const grade = Number(document.getElementById("grade").value);
  const personality = (document.getElementById("per").value || "")
                        .split(",")
                        .map(s => s.trim())
                        .filter(Boolean);

  if(!name || !grade || personality.length === 0){
    alert("이름, 학년, 성격 키워드를 모두 입력해주세요.");
    return;
  }

  state.characters.push({
    name,
    grade,
    personality,
    graduated: false,
    postGrad: null
  });
  showStudents();
}

// 캐릭터 수정
function editChar(i){
  const c = state.characters[i];
  document.getElementById("main").innerHTML = `
    <div class="card">
      이름 <input id="charName" value="${c.name || ""}"><br>
      학년 <input id="grade" type="number" min="1" max="3" value="${c.grade}"><br>
      성격 키워드 <input id="per" value="${c.personality.join(", ")}"><br>
      <button onclick="saveChar(${i})">저장</button>
    </div>
  `;
}

// 캐릭터 저장
function saveChar(i){
  const name = (document.getElementById("charName").value || "").trim();
  const grade = Number(document.getElementById("grade").value);
  const personality = (document.getElementById("per").value || "")
                        .split(",")
                        .map(s => s.trim())
                        .filter(Boolean);

  if(!name || !grade || personality.length === 0){
    alert("이름, 학년, 성격 키워드를 모두 입력해주세요.");
    return;
  }

  state.characters[i].name = name;
  state.characters[i].grade = grade;
  state.characters[i].personality = personality;
  showStudents();
}

// 캐릭터 삭제
function removeChar(i){
  if(confirm("삭제할까요?")){
    state.characters.splice(i,1);
    showStudents();
  }
}

// 졸업 체크
function checkGraduation(){
  state.characters.forEach(c=>{
    if(!c.graduated && c.grade === 3 && state.date.getMonth() >= 1){
      c.graduated = true;

      let r = prompt(`${c.name || "이름 없음"}는 졸업 후 어떻게 되나요?\n1. 대학교\n2. 아르바이트\n3. 백수\n4. 기타`);
      switch(r){
        case "1": c.postGrad = "대학생"; break;
        case "2": c.postGrad = "아르바이트"; break;
        case "3": c.postGrad = "백수"; break;
        case "4": c.postGrad = "다른 길"; break;
        default: c.postGrad = "미정"; break;
      }
    }
  });
}

updateDate();
</script>

</body>
</html>
